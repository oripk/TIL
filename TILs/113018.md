# 64비트 컴퓨팅
- 특징
    1. 32비트 프로그램은 SysWOW64 폴더에 있는 dll을 사용한다.
    2. 하지만 버전 하위 호환을 위해, 프로그램 내부적으로 후킹을 이용하여, Sysem32 폴더에 있는 dll을 사용하는 것처럼 보이게 한다.
    3. 32비트 프로그램은 Program Files(x86)이하에 설치된다.
    4. 레지스트리도 마찬가지로 64비트 위치와 32비트 위치가 다르다.
    5. 레지스트리도 하위 호환을 위해 32비트지만, 64비트 위치인 것 처럼 사용한다.

# x64 프로세서 이야기
- x86에서 x64로 오면서 변화한 것
    1. 레지스터들 이름
        원래 32비트에서는 앞에 Extended를 의미하는 E가 각 레지스터들 앞에 붙었다. 예를 들면 EAX, EBX 등이 있다. 그런데 64비트에서는 E대신 R이 붙는다. 
    2. 레지스터의 크기와 메모리의 주소의 크기 증가
        64비트로 늘어나면서 주소가 8자리 늘어났다. 그리고, 레지스터의 크기도 64비트로 늘어나게 되었다.
    3. 함수 호출 규약
        32비트에서는 세가지 정도의 함수 호출 규약이 있었다. 64비트에서는 개선된 fastcall을 사용한다. 이는 단순히 설명하면, 4개의 인자 값까지는 레지스터에 저장해 빠르게 관리하고, 이후는 스택에 저장하는 방식이다. 즉, 앞으로 64비트 프로그램을 짤 때는 되도록 함수의 인자를 4개 이하로 만드는 것이 속도면에서 유리하다.
    4. JMP와 CALL 명령어
        CALL 이나 JMP 명령어의 방식이 달라졌다. 주소가 8자리 늘어나게 되면서, 기존  32비트에서는 저 명령어들의 기계어 뒤에 절대주소가 붙었는데, 64비트 부터는 상대주소가 붙어서 실제로 점프하는 주소는 계산되어진 절대주소이다. 이로 인해 64비트의 넓은 주소를 사용하게 된다.
    5. 스택프레임 사용시 개선 사항
        스택프레임 사용시, pop이나 push와 같은 명령어 대신 mov 명령어를 많이 쓰게 되었다. 이로 인해 속도가 향상되었다. 또한 스택프레임에서 주소연산 시에 기존의 EBP에서 ESP 하나만 사용하게 되면서 EBP 계산을 안해도 되기에 속도가 굉장히 개선되었다고 한다.

# PE32+
- 기존의 PE32에서 64비트로 변화되면서 PE32+라는 이름으로 PE 파일의 포맷 이름이 바뀌었다.
    1. 포맷이 바뀌면서 가장 많이 바뀐 것은 각 구조체들의 크기이다.
        포인터 자료형과 long 자료형의 크기가 더욱 커지면서 각 구조체의 크기도 덩달아 커지게 되었다.
    2. Image_Opiontal_Header 구조체도 살짝 변했다. machine number가 64비트 machine으로 바뀌었고, BaseOfData가 삭제되었다.
    3. 32비트와의 호환을 위해 이름을 다르게 해놓고(식별을 위해) 나중에 이름을 통일한다.(호환을 위해)
    4. 이로 인해 PE32+ 포맷의 pe 파일을 분석할 때는 전용 분석기가 필요하다. 예를 들면 CFF Explorer가 있다.

# WinDbg
디버깅은 유저 모드와 커널 모드가 존재한다. 기존에는 유저 모드만 디버깅이 가능하지만, WinDbg를 사용하면 커널 모드 디버깅이 가능하다.
    - 특징
        1. 컴퓨터가 두대 필요하다. 실제 두대 혹은 가상 머신
        2. 커널을 디버깅하기 때문에 컴퓨터의 운영체제가 멈추게 된다.
        3. 실제 프로그램이 동작하는 메모리에 접근할 수 있다. 
        4. PEB나 TEB등 디버깅 용도로 만들어진 파일들 (심볼이 존재해 일단 PE파일에 비해 가독성이 월등히 뛰어나다. 하지만 제작자만 보유하고 있다. 왜냐하면 빌드할 때 만들어지는 파일이기 때문이다.)